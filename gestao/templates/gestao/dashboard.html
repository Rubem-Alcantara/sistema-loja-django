{% extends 'gestao/base.html' %}

{% block content %}
<div class="mb-4">
    <h2 class="fw-bold"><i class="bi bi-speedometer2"></i> Painel Administrativo</h2>
    <p class="text-muted">Visão geral do sistema</p>
</div>

<div class="row">
    <div class="col-md-3 mb-4">
        <div class="card text-white bg-primary shadow h-100">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="card-title mb-0">Total Produtos</h6>
                        <h2 class="display-4 fw-bold mb-0">{{ total_produtos }}</h2>
                    </div>
                    <i class="bi bi-box-seam fs-1 opacity-50"></i>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-3 mb-4">
        <div class="card text-white bg-danger shadow h-100">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="card-title mb-0">Estoque Baixo</h6>
                        <h2 class="display-4 fw-bold mb-0">{{ baixo_estoque }}</h2>
                    </div>
                    <i class="bi bi-exclamation-triangle fs-1 opacity-50"></i>
                </div>
                <small>Produtos com menos de 5 unidades.</small>
            </div>
        </div>
    </div>

    <div class="col-md-3 mb-4">
        <div class="card text-dark bg-light border shadow-sm h-100">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="card-title mb-0">Categorias</h6>
                        <h2 class="display-4 fw-bold mb-0 text-secondary">{{ total_categorias }}</h2>
                    </div>
                    <i class="bi bi-tags fs-1 text-secondary opacity-50"></i>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-3 mb-4">
        <div class="card text-white bg-success shadow h-100">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="card-title mb-0">Valor em Estoque</h6>
                        <h3 class="fw-bold mb-0">R$ {{ valor_estoque|floatformat:2 }}</h3>
                    </div>
                    <i class="bi bi-cash-coin fs-1 opacity-50"></i>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-md-12">
        <div class="card shadow-sm border-danger">
            <div class="card-header bg-danger text-white d-flex justify-content-between align-items-center">
                <h5 class="mb-0"><i class="bi bi-exclamation-triangle-fill"></i> Atenção: Produtos com Estoque Baixo</h5>
            </div>
            <div class="card-body p-0">
                <table class="table table-hover mb-0">
                    <thead class="table-light">
                        <tr>
                            <th>Produto</th>
                            <th>Qtd Atual</th>
                            <th>Preço</th>
                            <th>Ação</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for produto in lista_alerta %}
                        <tr>
                            <td class="fw-bold">{{ produto.nome }}</td>
                            <td>
                                <span class="badge bg-danger rounded-pill">{{ produto.quantidade }}</span>
                            </td>
                            <td>R$ {{ produto.preco }}</td>
                            <td>
                                <a href="{% url 'produto_edit' produto.id %}" class="btn btn-sm btn-outline-danger">
                                    <i class="bi bi-box-arrow-in-right"></i> Repor Estoque
                                </a>
                            </td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="4" class="text-center text-success py-3">
                                <i class="bi bi-check-circle-fill"></i> Tudo certo! Nenhum produto com estoque baixo.
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<div class="row mt-4">
    <div class="col-md-6">
        <div class="card shadow-sm">
            <div class="card-header bg-white fw-bold">Atalhos</div>
            <div class="list-group list-group-flush">
                <a href="/admin/" target="_blank" class="list-group-item list-group-item-action">
                    <i class="bi bi-gear-fill me-2"></i> Acessar Django Admin Avançado
                </a>
                <a href="{% url 'produto_novo' %}" class="list-group-item list-group-item-action">
                    <i class="bi bi-plus-circle me-2"></i> Cadastrar Novo Produto
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}